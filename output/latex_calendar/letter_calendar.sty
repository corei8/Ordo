\NeedsTeXFormat{LaTeX2e}

\def\CalendarVersion{1.0}
\def\CalendarVersionDate{2023/07/05}

\ProvidesClass{letter_calendar}[\CalendarVersionDate
           LaTeX2e class file `calendar' v\CalendarVersion]

\typeout{'letter_calendar' style \CalendarVersion \CalendarVersionDate.}
\typeout{Created by Fr. G.R.Barnes}
\typeout{corei8.github@gmail.com}

\RequirePackage{tabularx}
\RequirePackage[dvipsnames]{xcolor}
\RequirePackage{makecell}
\RequirePackage{ragged2e}
\RequirePackage{caption}
\RequirePackage{graphicx}
\RequirePackage{setspace}

\graphicspath{ {./dore/} }

% \RequirePackage{lua-visual-debug}

\newcommand{\officecolor}[1]{
  \fboxsep=.5em \fboxrule=.03em
  \fcolorbox{black}{#1}{\null}
}

\newenvironment{monthcanvas}{
    \begin{tabularx}{\textwidth}{|X|X|X|X|X|X|X|}
}{
    \end{tabularx}
  }

\newcommand\themonth[2]{
  \begin{center}
      \textsc{\Huge #1}\\
  \end{center}
  \vfill
  \begin{figure}[h]
    \centering
    \includegraphics[height=.75\textheight,width=\textwidth]{example-image-a}\\
  \end{figure}
  \pagebreak
}

% \renewcommand\baselinestretch{1.0}

\newcommand\theday[5]{
  \makecell{
    % \mbox{\vspace{1.25in}%
    % \colorbox{#5}{
    % \begin{minipage}[b][1.125in][s]{\TX@col@width}
    \begin{minipage}[b][0.143\textheight][s]{\TX@col@width}
      {\scriptsize\bfseries #1} \\
      \vfill
      \begin{spacing}{0.75}
        {\scriptsize\RaggedRight #2} \\
      \end{spacing}
      {\scriptsize\textcolor{red}{#3}} \\
      \vfill
      {\scriptsize \officecolor{#4} \hfill $\vcenter{\hbox{\includegraphics[width=3em]{#5.png}}}$}
    \end{minipage}
    % }
    % }
  }
}

\newcolumntype{Y}{>{\centering\arraybackslash}X}

\newcommand\latinweekdays{
  \begin{tabularx}{\textwidth}{@{}YYYYYYY@{}}
        {\scshape\scriptsize Dominica} &
        {\scshape\scriptsize Feria II} &
        {\scshape\scriptsize Feria III} &
        {\scshape\scriptsize Feria IV} &
        {\scshape\scriptsize Feria v} &
        {\scshape\scriptsize Feria VI} &
        {\scshape\scriptsize Sabbatum} \\
    \end{tabularx}
  }

\newcommand\englishweekdays{
    \begin{tabularx}[\linewidth]{ X X X X X X X }
      Sunday &
      Monday &
      Tuesday &
      Wednesday &
      Thursday &
      Friday &
      Saturday \\
    \end{tabularx}
  }
